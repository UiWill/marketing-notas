================================================================================
GUIA COMPLETO: COMO ATUALIZAR AS EDGE FUNCTIONS NO SUPABASE
================================================================================

Voc√™ precisa atualizar 3 fun√ß√µes no painel do Supabase.
Siga estas instru√ß√µes passo a passo:

================================================================================
PASSO 1: ACESSAR O PAINEL DO SUPABASE
================================================================================

1. Abra o navegador
2. Acesse: https://supabase.com/dashboard/project/xtxuoqcunnlccnujbbhk/functions
3. Voc√™ ver√° a lista das Edge Functions

================================================================================
PASSO 2: ATUALIZAR FUN√á√ÉO 1 - asaas-webhook (MAIS IMPORTANTE!)
================================================================================

Esta √© a fun√ß√£o que recebe os webhooks do Asaas quando o pagamento √© confirmado.

1. Na lista de fun√ß√µes, clique em "asaas-webhook"
2. Clique no bot√£o "Edit" ou √≠cone de l√°pis
3. Apague TODO o c√≥digo que est√° l√°
4. Abra o arquivo: ATUALIZAR_SUPABASE_1_asaas-webhook.txt
5. Copie TODO o c√≥digo do arquivo
6. Cole no editor do Supabase
7. Clique em "Deploy" ou "Save & Deploy"
8. Aguarde a mensagem de sucesso

================================================================================
PASSO 3: ATUALIZAR FUN√á√ÉO 2 - asaas-payment
================================================================================

Esta fun√ß√£o cria o pagamento no Asaas quando o cliente vai para o checkout.

1. Volte para a lista de fun√ß√µes
2. Clique em "asaas-payment"
3. Clique no bot√£o "Edit" ou √≠cone de l√°pis
4. Apague TODO o c√≥digo que est√° l√°
5. Abra o arquivo: ATUALIZAR_SUPABASE_2_asaas-payment.txt
6. Copie TODO o c√≥digo do arquivo
7. Cole no editor do Supabase
8. Clique em "Deploy" ou "Save & Deploy"
9. Aguarde a mensagem de sucesso

================================================================================
PASSO 4: ATUALIZAR FUN√á√ÉO 3 - asaas-get-payment
================================================================================

Esta fun√ß√£o busca os dados do pagamento para mostrar na p√°gina de obrigado.

1. Volte para a lista de fun√ß√µes
2. Clique em "asaas-get-payment"
3. Clique no bot√£o "Edit" ou √≠cone de l√°pis
4. Apague TODO o c√≥digo que est√° l√°
5. Abra o arquivo: ATUALIZAR_SUPABASE_3_asaas-get-payment.txt
6. Copie TODO o c√≥digo do arquivo
7. Cole no editor do Supabase
8. Clique em "Deploy" ou "Save & Deploy"
9. Aguarde a mensagem de sucesso

================================================================================
PASSO 5: TESTAR NO ASAAS
================================================================================

Agora vamos testar se o webhook est√° funcionando:

1. Volte para o painel do Asaas
2. V√° em: Integra√ß√µes > Webhooks > Logs de Webhooks
3. Encontre um webhook com erro 401
4. Clique em "Reenviar da fila"
5. Aguarde alguns segundos
6. Verifique se agora aparece "Status 200" (sucesso!)

Se aparecer status 200, TUDO FUNCIONOU! ‚úÖ

================================================================================
PASSO 6: FAZER UM TESTE COMPLETO
================================================================================

Para ter certeza que tudo est√° funcionando:

1. Abra o site: https://dnotas.github.io/Landepage-ELI/
2. Preencha o formul√°rio com seus dados de teste
3. V√° para o checkout
4. Escolha PIX
5. Fa√ßa um pagamento de R$ 5,00
6. Na p√°gina de Obrigado, aguarde alguns segundos
7. A p√°gina deve atualizar automaticamente quando o pagamento for confirmado
8. Voc√™ deve receber 2 WhatsApp:
   - Um no n√∫mero do cliente (que voc√™ cadastrou)
   - Um no n√∫mero do Eli: 18 99668-2525

================================================================================
O QUE CADA FUN√á√ÉO FAZ:
================================================================================

üìå asaas-webhook
   - Recebe notifica√ß√µes do Asaas quando pagamento √© confirmado
   - Atualiza o banco de dados com o status
   - Envia WhatsApp para o cliente
   - Envia WhatsApp para o Eli

üìå asaas-payment
   - Cria o cliente no Asaas
   - Cria a cobran√ßa (PIX, Boleto ou Cart√£o)
   - Gera o QR Code do PIX
   - Salva os dados no banco

üìå asaas-get-payment
   - Busca informa√ß√µes do pagamento
   - Usado na p√°gina de Obrigado para mostrar o QR Code

================================================================================
PROBLEMAS COMUNS:
================================================================================

‚ùå Se der erro 401 no webhook:
   ‚Üí Voc√™ ainda n√£o atualizou a fun√ß√£o asaas-webhook
   ‚Üí Siga o PASSO 2 novamente

‚ùå Se o WhatsApp n√£o chegar:
   ‚Üí Verifique se o webhook est√° com status 200
   ‚Üí Verifique o n√∫mero do WhatsApp est√° correto
   ‚Üí Veja os logs da fun√ß√£o no Supabase

‚ùå Se a p√°gina n√£o atualizar automaticamente:
   ‚Üí Aguarde at√© 10 segundos (polling a cada 5 segundos)
   ‚Üí Verifique se o leadId foi passado na URL
   ‚Üí Atualize a p√°gina manualmente

================================================================================
D√öVIDAS?
================================================================================

Se algo n√£o funcionar, verifique:
1. As 3 fun√ß√µes foram atualizadas?
2. O deploy foi feito com sucesso?
3. O webhook no Asaas est√° configurado?
4. Os eventos corretos est√£o selecionados no Asaas?

================================================================================
